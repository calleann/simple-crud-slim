{% extends 'templates/app.html.twig' %}

{%block content%}
      <div class="col-lg-12">
        {% if count == 0 %}
          {% if statut == 0 %}
              <div class="row">
                <div class="alert alert-info" role="alert"><p>Vous avez saisi tous les documents.Si vous souhaitez soumettre votre dosier,allez à "soumettre votre dossier" ou cliquez <a href="{{path_for("demande.submit")}}"><strong>ici</strong></a>.</p></div>
              </div>
          {% else %}
              <div class="row">
                <div class="alert alert-success" role="alert"><p>Vous avez envoyé votre dossier.</p></div>
              </div>
          {% endif %}
        {% endif %}
        <div class="row">
          <div class="panel panel-default">
          <div class="panel-heading"><strong>Dossier exploitation</strong></div>
          <div class="panel-body">
                    <!-- {{error | json_encode }}
                    {{dossier_fils | json_encode }} -->
          <table class="table table-bordered table-responsive">
            <tbody>
              <form class="form-signin" action="{{path_for('demande.test')}}" method="post" enctype="multipart/form-data">
                <!-- 1-->
                <tr class="{{dossier_fils.demande_ecrite ? 'bg-success':''}} {{error.demande_ecrite ? 'bg-danger':''}}">
                  <td width="75%">
                      <label for="demande_ecrite">fichier Demande écrite:</label><br>
                      {% if dossier_fils.demande_ecrite is not empty %}
                        <p><a target="_blank"  href="../dossiers/{{id}}/{{dossier_fils.demande_ecrite}}">consulter</a></p>
                        <span class='label label-success'>Complet</span>
                      {% endif %}
                      {% if error.demande_ecrite %}
                        <span class='label label-danger'>fichier manquant</span>
                      {% endif %}
                  </td>
                  <td width="25%" align="center">
                    <label class="btn btn-default" {{statut == 0 ? '':'disabled'}} for="demande_ecrite">
                      <input id="demande_ecrite" type="file" name="test[demande_ecrite]" style="display:none;" {{statut == 0 ? '':'disabled'}} onchange="$('#upload-file-info-1').html($(this).val());">
                      Charger ici
                    </label>
                    <span class='label label-default' id="upload-file-info-1"></span>
                  </td>
                </tr>
                <!-- 2-->
                <tr class="{{dossier_fils.architecte ? 'bg-success':''}} {{error.architecte ? 'bg-danger':''}}">
                  <td width="75%">
                      <label for="architecte">fichier Conformité Architecte:</label><br>
                      {% if dossier_fils.architecte is not empty %}
                        <p><a target="_blank"  href="../dossiers/{{id}}/{{dossier_fils.architecte}}">consulter</a></p>
                        <span class='label label-success'>Complet</span>
                      {% endif %}
                      {% if error.architecte %}
                        <span class='label label-danger'>fichier manquant</span>
                      {% endif %}
                  </td>
                  <td width="25%" align="center">
                    <label class="btn btn-default" {{statut == 0 ? '':'disabled'}} for="architecte">
                      <input id="architecte" type="file" name="test[architecte]" style="display:none;" {{statut == 0 ? '':'disabled'}} onchange="$('#upload-file-info-2').html($(this).val());">
                      Charger ici
                    </label>
                    <span class='label label-default' id="upload-file-info-2"></span>
                  </td>
                </tr>
                <!-- 3-->
                <tr class="{{dossier_fils.bureau_controle ? 'bg-success':''}} {{error.bureau_controle ? 'bg-danger':''}}">
                  <td width="75%">
                      <label for="bureau_controle">fichier Conformité Bureau de contrôle:</label><br>
                      {% if dossier_fils.bureau_controle is not empty %}
                        <p><a target="_blank"  href="../dossiers/{{id}}/{{dossier_fils.bureau_controle}}">consulter</a></p>
                        <span class='label label-success'>Complet</span>
                      {% endif %}
                      {% if error.bureau_controle %}
                        <span class='label label-danger'>fichier manquant</span>
                      {% endif %}
                  </td>
                  <td width="25%" align="center">
                    <label class="btn btn-default" {{statut == 0 ? '':'disabled'}} for="bureau_controle">
                      <input id="bureau_controle" type="file" name="test[bureau_controle]" style="display:none;" {{statut == 0 ? '':'disabled'}} onchange="$('#upload-file-info-3').html($(this).val());">
                      Charger ici
                    </label>
                    <span class='label label-default' id="upload-file-info-3"></span>
                  </td>
                </tr>
                <!-- 4-->
                <tr class="{{dossier_fils.assurance ? 'bg-success':''}} {{error.assurance ? 'bg-danger':''}}">
                  <td width="75%">
                      <label for="assurance">fichier Assurance:</label><br>
                      {% if dossier_fils.assurance is not empty %}
                        <p><a target="_blank"  href="../dossiers/{{id}}/{{dossier_fils.assurance}}">consulter</a></p>
                        <span class='label label-success'>Complet</span>
                      {% endif %}
                      {% if error.assurance %}
                        <span class='label label-danger'>fichier manquant</span>
                      {% endif %}
                  </td>
                  <td width="25%" align="center">
                    <label class="btn btn-default" {{statut == 0 ? '':'disabled'}} for="assurance">
                      <input id="assurance" type="file" name="test[assurance]" style="display:none;" {{statut == 0 ? '':'disabled'}} onchange="$('#upload-file-info-4').html($(this).val());">
                      Charger ici
                    </label>
                    <span class='label label-default' id="upload-file-info-4"></span>
                  </td>
                </tr>
                <!-- 5-->
                <tr class="{{dossier_fils.protection_civile ? 'bg-success':''}} {{error.protection_civile ? 'bg-danger':''}}">
                  <td width="75%">
                      <label for="protection_civile">fichier Protection civile:</label><br>
                      {% if dossier_fils.protection_civile is not empty %}
                        <p><a target="_blank"  href="../dossiers/{{id}}/{{dossier_fils.protection_civile}}">consulter</a></p>
                        <span class='label label-success'>Complet</span>
                      {% endif %}
                      {% if error.protection_civile %}
                        <span class='label label-danger'>fichier manquant</span>
                      {% endif %}
                  </td>
                  <td width="25%" align="center">
                    <label class="btn btn-default" {{statut == 0 ? '':'disabled'}} for="protection_civile">
                      <input id="protection_civile" type="file" name="test[protection_civile]" style="display:none;" {{statut == 0 ? '':'disabled'}} onchange="$('#upload-file-info-5').html($(this).val());">
                      Charger ici
                    </label>
                    <span class='label label-default' id="upload-file-info-5"></span>
                  </td>
                </tr>
                <!-- 6-->
                <tr class="{{dossier_fils.reseau ? 'bg-success':''}} {{error.reseau ? 'bg-danger':''}}">
                  <td width="75%">
                      <label for="reseau">fichier Plan reseau:</label><br>
                      {% if dossier_fils.reseau is not empty %}
                        <p><a target="_blank"  href="../dossiers/{{id}}/{{dossier_fils.reseau}}">consulter</a></p>
                        <span class='label label-success'>Complet</span>
                      {% endif %}
                      {% if error.reseau %}
                        <span class='label label-danger'>fichier manquant</span>
                      {% endif %}
                  </td>
                  <td width="25%" align="center">
                    <label class="btn btn-default" {{statut == 0 ? '':'disabled'}} for="reseau">
                      <input id="reseau" type="file" name="test[reseau]" style="display:none;" {{statut == 0 ? '':'disabled'}} onchange="$('#upload-file-info-6').html($(this).val());">
                      Charger ici
                    </label>
                    <span class='label label-default' id="upload-file-info-6"></span>
                  </td>
                </tr>
                <!-- 7-->
                <tr class="{{dossier_fils.recollement ? 'bg-success':''}} {{error.recollement ? 'bg-danger':''}}">
                  <td width="75%">
                      <label for="recollement">fichier Plan de recollement:</label><br>
                      {% if dossier_fils.recollement is not empty %}
                        <p><a target="_blank"  href="../dossiers/{{id}}/{{dossier_fils.recollement}}">consulter</a></p>
                        <span class='label label-success'>Complet</span>
                      {% endif %}
                      {% if error.recollement %}
                        <span class='label label-danger'>fichier manquant</span>
                      {% endif %}
                  </td>
                  <td width="25%" align="center">
                    <label class="btn btn-default" {{statut == 0 ? '':'disabled'}} for="recollement">
                      <input id="recollement" type="file" name="test[recollement]" style="display:none;" {{statut == 0 ? '':'disabled'}} onchange="$('#upload-file-info-7').html($(this).val());">
                      Charger ici
                    </label>
                    <span class='label label-default' id="upload-file-info-7"></span>
                  </td>
                </tr>
                <!-- 8 -->
                <tr class="{{dossier_fils.fin_suivi ? 'bg-success':''}} {{error.fin_suivi ? 'bg-danger':''}}">
                  <td width="75%">
                      <label for="fin_suivi">fichier fin de suivi:</label><br>
                      {% if dossier_fils.fin_suivi is not empty %}
                        <p><a target="_blank"  href="../dossiers/{{id}}/{{dossier_fils.fin_suivi}}">consulter</a></p>
                        <span class='label label-success'>Complet</span>
                      {% endif %}
                      {% if error.fin_suivi %}
                        <span class='label label-danger'>fichier manquant</span>
                      {% endif %}
                  </td>
                  <td width="25%" align="center">
                    <label class="btn btn-default" {{statut == 0 ? '':'disabled'}} for="fin_suivi">
                      <input id="fin_suivi" type="file" name="test[fin_suivi]" style="display:none;" {{statut == 0 ? '':'disabled'}} onchange="$('#upload-file-info-8').html($(this).val());">
                      Charger ici
                    </label>
                    <span class='label label-default' id="upload-file-info-8"></span>
                  </td>
                </tr>
              <tr>
                <td colspan="2" align="center">
                  <button type="submit" class="btn btn-primary" {{statut == 0 ? '':'disabled'}}>Submit</button>
                </td>
              </tr>
            </form>
            </tbody>
          </table>
          </div>
        </div>
        </div>
      </div>

      <script type="text/javascript">
        var count = {{count}};
        console.log(count);
        $(document).ready(function(){
          $("table tbody tr").click(function(){
            $(this).find(".label-danger").each(function(){
              $(this).hide("slow");
            });
          });
        });
      </script>
{% endblock %}
